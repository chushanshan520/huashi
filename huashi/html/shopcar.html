<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
		<link href="../css/public.css" rel="stylesheet" type="text/css">
		<link href="../css/shopcar.css" rel="stylesheet" type="text/css">
	</head>
	<body>
		<div id="top">
			<a href="#"></a>
		</div>
		
		<nav>
			<div class="margin">
				<p class="p1">花市网-中国鲜花领先品牌<a href="#">{切换城市}</a></p>
				<ul>
					<li class="first"><a href="#">订单查询</a></li>
					<li class="list1"><a href="#">我的订单</a><i></i>
						<p>
							<a href="#">待付款订单</a>
							<a href="#">待确认收货</a>
							<a href="#">待评价交易</a>
						</p>
					</li>
					<li><a href="#">商品收藏</a></li>
					<li  class="list2"><a href="#">客户服务</a><i></i>
						<p>
							<a href="#">帮助中心</a>
							<a href="#">售后服务</a>
							<a href="#">服务中心</a>
						</p>
					</li>
					<li class="last"><a href="#">合作或加盟</a></li>
				</ul>
			</div>
		</nav>
		
		<header class="margin">
			<a href="#" class="logo"><img src="../images/index/05166631110429063.jpg"/></a>
			<div class="mid">
				<p>商品</p>
				<input type="text" id="txt" placeholder="请输入您想要搜索的商品关键字"/><input type="button" id="btn" value="搜索" />
				<ul>
					<li><a href="#">热门搜索:</a></li>
				    <li><a href="#">玫瑰</a></li>
				    <li><a href="#">百合</a></li>
				    <li><a href="#">蓝色妖姬</a></li>
				    <li><a href="#">爱情</a></li>
				    <li><a href="#">花篮</a></li>
				    <li><a href="#">教师</a></li>
				    <li><a href="#">七夕</a></li>
				    <li><a href="#">情人</a></li>
				</ul>
			</div>
			<div class="right">
				<ul>
					<li>
						<a href="#"><img src="../images/index/tel.png" />4006-897-397</a>
					</li>
					<li>
						<a href="#"><img src="../images/index/kf.gif" />在线客服</a>
					</li>
					<li><a href="index.html">回到首页</a></li>
					<li><a href="list.html">去购物</a></li>
					<li><a href="#">去付款</a></li>
				</ul>
			</div>
		</header>
		
		<div id="car" class="margin">
			<h3>
				全选：<input type="checkbox" class="all"/>
			</h3>
			<h5>
				<i>选择</i>
				<i>名称</i>
				<i>图片</i>
				<i>价格</i>
				<i>删除</i>
			</h5>
			<table cellpadding="10">
				<tr>
					<!-- <td>
						<input type="checkbox" />
						<img src="../images/goods/1.1.jpg" />
						<h2>价格：<b>￥123</b><input type="number" min="1" value="0" class="num"/></h2>
						<h4>删除</h4>
					</td> -->
					
				</tr>
			</table>
			<p>总计：￥<b>0</b></p>
		</div>
		
		<div id="real">
			<div class="bto">
				<ul class="ul2 margin"> 
					<li>
						<h3>购物指南</h3>
						<a href="#">VIP会员</a>
						<a href="#">品牌服务</a>
						<a href="#">订购必读</a>
						<a href="#">购物流程</a>
					</li>
					<li>
						<h3>支付方式</h3>
						<a href="#">在线支付</a>
						<a href="#">发票说明</a>
						<a href="#">银行转账说明</a>
						<a href="#">货到付款及要求</a>
					</li>
					<li>
						<h3>配送方式</h3>
						<a href="#">配送说明</a>
						<a href="#">配送范围</a>
						<a href="#">鲜花定时配送</a>
						<a href="#">配送费用收取标准</a>
					</li>
					<li>
						<h3>售后服务</h3>
						<a href="#">订单处理</a>
						<a href="#">在线支付</a>
						<a href="#">投诉处理规范</a>
						<a href="#">订单查询及撤销</a>
						<a href="#">修改订单信息说明</a>
					</li>
					<li>
						<h3>相关知识</h3>
						<a href="#">花语大全</a>
						<a href="#">送花攻略</a>
						<a href="#">养花知识</a>
					</li>
					<li>
						<h3>帮助中心</h3>
						<a href="#">关于我们</a>
						<a href="#">联系我们</a>
						<a href="#">安全条款</a>
						<a href="#">隐私保护</a>
						<a href="#">常见问题</a>
					</li>
					<li>
						<b>花店经营</b>
						<b>9:00-20:00</b>
						<b>花店留言回复时间</b>
						<b>9:00-22:00</b>
					</li>
					<li>
						<b>花店服务热线(24小时免费)</b>
						<h2><i><img src="../images/index/dian.png"/></i>4006-2399-323</h2>
					</li>
				</ul>
			</div>
		</div>
		
		<div id="footer">
			<div class="margin">
				<div class="top">
					<p>
						<b>热门城市:</b>
						<a href="#">北京石景山区金顶街附近鲜花店</a>
						<a href="#">重庆市巴南区李家沱附近鲜花店</a>
						<a href="#">深圳市龙华区观澜街道附近鲜花店</a>
						<a href="#">忻州河曲移民村附近鲜花店</a>
						<a href="#">上海交通大学附近鲜花店</a>
						<a href="#">重庆市巴南区李家沱附近鲜花店</a>
						<a href="#">更多</a>
					</p>
					<p>
						<b>友情链接:</b>
						<a href="#">鲜花速递</a>
						<a href="#">网上花店</a>
						<a href="#">鲜花速递</a>
						<a href="#">农业之友</a>
						<a href="#">网上鲜花店</a>
						<a href="#">男士网</a>
						<a href="#">花卉价格</a>
						<a href="#">花仙居</a>
						<a href="#">车图片</a>
						<a href="#">温州装修</a>
						<a href="#">中国农产品网</a>
						<a href="#">农村致富项目</a>
						<a href="#">购物网站</a>
						<a href="#">公司法律师</a>
						<a href="#">珠宝首饰</a>
						<a href="#">包装印刷厂</a>
						<a href="#">更多</a>
					</p>
				</div>
				<div class="bto">
				<h3>
					<a href="#">送花攻略</a>
					<span>|</span>
					<a href="#">花语大全</a>
					<span>|</span>
					<a href="#">爱情鲜花</a>
					<span>|</span>
					<a href="#">生日鲜花</a>
					<span>|</span>
					<a href="#">开业花篮</a>
					<span>|</span>
					<a href="#">给老师送花</a>
					<span>|</span>
					<a href="#">客服中心</a>
					<span>|</span>
					<a href="#">网站地图</a>
					<span>|</span>
					<a href="#">友情链接</a>
					
				</h3>
				<h3>花市网 版权所有，并保留所有权利。</h3>
				<h3>ICP备案证书号：蜀ICP备1611133号</h3>
				</div>
				<ul>
					<li><i><img src="../images/index/xin.png"/></i><b>诚信网站示范企业</b></li>
					<li><i><img src="../images/index/yuan.png"/></i><b>可信网站信用评价</b></li>
					<li><i><img src="../images/index/h.png"/></i><b>诚信网站示范企业</b></li>
				</ul>
			</div>
		</div>
	</body>
	
	<script src="../js/jquery.js"></script>
	<script src="../js/cookie.js"></script>
	<script src="../js/ajax.js"></script>
	<script>
		$("#reu .left p").hover(function(){
			$("#reu .ul1").css("display","block");
			$("#reu .left .ul1 li").hover(function(){
				$("#reu .left .ul2").children("li").css("display","none").eq($(this).index()).css("display","inline-block");
			},function(){
				$("#reu .left .ul2").hover(function(){
				},function(){
				$("#reu .left .ul2").children("li").css("display","none");
				$("#reu .ul1").css("display","none");
				})
			})
		
		},function(){
		})
		
	class List{
		constructor(options) {
				this.url=options.url;
				this.car=options.car;
				this.shop=getCookie("shop") ? JSON.parse(getCookie("shop")) : [];
				this.prices=getCookie("prices") ? JSON.parse(getCookie("prices")) : [];
				this.load();
				this.p=document.querySelector("#car p b");
				this.all=document.querySelector("#car h3 input.all");
				// this.more=document.getElementsByClassName(".more");
				
				this.removeEvent();
				
			}
			load(){
				var that=this;
				ajaxGet(this.url,function(res){
					that.res=JSON.parse(res);
					that.display();
					that.more=document.getElementsByClassName("more");
					that.emvalue=document.querySelector("em");
					that.selectAll();
				})
			}

		display(){
				var str="";
				for(var i=0;i<this.shop.length;i++){
					for(var j=0;j<this.res.length;j++){
						if(this.shop[i].id==this.res[j].id){
							str+=`
								<td index="${this.res[i].id}">
									<input type="checkbox" class="more"/>
									<em>${this.res[j].name}</em>
									<img src="${this.res[j].img.img1}" />
									<h2>价格：<b>${this.res[j].price.price1}</b><input type="number" min="1" value="${this.shop[i].num}" class="num"/></h2>
									<h4><b>删除</b></h4>
								</td>
								
							`;
								
						}
					}
					
				}
			this.car.innerHTML=str;
			
			
		}
		

		removeEvent(){
			var that=this;
			this.car.addEventListener("click",function(eve){
				if(eve.target.tagName=="B"){
					that.id=eve.target.parentNode.parentNode.getAttribute("index");
					eve.target.parentNode.parentNode.remove();
					that.removeCookie();
				}
			})
			
			this.car.addEventListener("input",function(eve){
				if(eve.target.tagName=="INPUT"){
					that.id=eve.target.parentNode.parentNode.getAttribute("index");
					that.value=eve.target.value;
					that.changeCookie();
					// if(eve.target.className=="num"){
					// 		pri=eve.target.previousElementSibling.innerHTML.slice(1);
					// 		for(var i=0;i<that.shop.length;i++){
					// 			if(that.shop[i].id==that.id){
					// 				count=Number(that.value)*pri;
					// 			}
					// 		}
					// 		that.p.innerHTML=count;
					// }
						
					
				}
			})
		}
		
		removeCookie(){
			for(var i=0;i<this.shop.length;i++){
				if(this.shop[i].id==this.id){
					this.shop.splice(i,1);
				}
			}
			setCookie("shop",JSON.stringify(this.shop));
		}
		
		changeCookie(){
			for(var i=0;i<this.shop.length;i++){
				if(this.shop[i].id==this.id){
					this.shop[i].num=this.value;
				}
			}
			setCookie("shop",JSON.stringify(this.shop));
		}
		
	// 	select(){
	// 		var that=this;
	// 		this.car.addEventListener("click",function(eve){
	// 			if(eve.target.className=="more"){
	// 				for(var i=0;i<that.more.length;i++){
						
	// 				}
	// 			}
	// 		})
	// }	
		
		selectAll(){
			var that=this;
			this.all.onclick=function(){
				for(var i=0;i<that.more.length;i++){
					that.more[i].checked=that.all.checked;
				}
				if(that.all.checked==true){
					that.selvalue();
					
				}else{
					that.p.innerHTML=0;
				}
			}
			
		}
		
		selvalue(){
			var that=this;
			var shopvalue=0;
			var resvalue=0;
			// console.log(this.res[1].price.price1);
			for(var i=0;i<this.shop.length;i++){
				for(var j=0;j<this.res.length;j++){
					if(this.shop[i].id==this.res[j].id){
						shopvalue+=Number(this.shop[i].num)*Number(this.res[j].price.price1.slice(1));
						that.p.innerHTML=shopvalue;
					}
				}
			}
		
		}

	}
	new List({
		url:"http://localhost/test1910/花市网/json/goods.json",
		car:document.querySelector("#car table tr")
	})
	</script>
</html>
